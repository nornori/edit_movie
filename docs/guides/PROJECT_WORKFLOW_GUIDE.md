# å‹•ç”»ç·¨é›†AI - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®æµã‚Œï¼ˆã‚«ãƒƒãƒˆé¸æŠç‰ˆï¼‰

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„
å‹•ç”»ã‹ã‚‰è‡ªå‹•çš„ã«**æœ€é©ãªã‚«ãƒƒãƒˆä½ç½®**ã‚’äºˆæ¸¬ã—ã€Premiere Proç”¨ã®XMLã‚’ç”Ÿæˆã™ã‚‹

**ç¾åœ¨ã®é–‹ç™ºãƒ•ã‚©ãƒ¼ã‚«ã‚¹**: ã‚«ãƒƒãƒˆé¸æŠï¼ˆCut Selectionï¼‰ã«ç‰¹åŒ–
- âœ… ã‚«ãƒƒãƒˆé¸æŠãƒ¢ãƒ‡ãƒ«: å‹•ä½œä¸­ï¼ˆå¹³å‡F1: 42.30%ã€æœ€è‰¯: 49.42%ï¼‰
- âš ï¸ ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯é…ç½®ãƒ»ãƒ†ãƒ­ãƒƒãƒ—ç”Ÿæˆ: ç²¾åº¦ãŒä½ã„ãŸã‚ä»Šå¾Œã®èª²é¡Œ

---

## ğŸ“Š å…¨ä½“ãƒ•ãƒ­ãƒ¼å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. ãƒ‡ãƒ¼ã‚¿æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1-1. ç·¨é›†æ¸ˆã¿å‹•ç”» + Premiere Pro XMLã‚’ç”¨æ„           â”‚
    â”‚      (editxml/)                                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1-2. å‹•ç”»ã‹ã‚‰ç‰¹å¾´é‡ã‚’æŠ½å‡º                            â”‚
    â”‚      python extract_video_features_parallel.py       â”‚
    â”‚      â†’ data/processed/source_features/*.csv          â”‚
    â”‚      (éŸ³å£° + æ˜ åƒ + æ™‚ç³»åˆ—ç‰¹å¾´é‡)                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1-3. XMLã‹ã‚‰ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ™ãƒ«ã‚’æŠ½å‡º                   â”‚
    â”‚      python extract_active_labels.py                 â”‚
    â”‚      â†’ data/processed/active_labels/*.csv            â”‚
    â”‚      (æ¡ç”¨/ä¸æ¡ç”¨ã®åˆ¤å®š)                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1-4. æ™‚ç³»åˆ—ç‰¹å¾´é‡ã‚’è¿½åŠ                               â”‚
    â”‚      python scripts/add_temporal_features.py         â”‚
    â”‚      â†’ data/processed/source_features/*_enhanced.csv â”‚
    â”‚      (ç§»å‹•å¹³å‡ã€å¤‰åŒ–ç‡ã€ã‚«ãƒƒãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ç­‰)           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1-5. K-Foldç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ                            â”‚
    â”‚      python scripts/create_combined_data_for_kfold.pyâ”‚
    â”‚      â†’ preprocessed_data/combined_sequences.npz      â”‚
    â”‚      (å‹•ç”»å˜ä½ã§åˆ†å‰²ã€ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯é˜²æ­¢)               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2. å­¦ç¿’ãƒ•ã‚§ãƒ¼ã‚º                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2-1. K-Fold Cross Validationã§å­¦ç¿’                   â”‚
    â”‚      train_cut_selection_kfold_enhanced.bat          â”‚
    â”‚      â†’ checkpoints_cut_selection_kfold_enhanced/     â”‚
    â”‚      (5-Foldã€GroupKFoldã€ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯é˜²æ­¢)          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2-2. å­¦ç¿’çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç¢ºèª                      â”‚
    â”‚      ãƒ–ãƒ©ã‚¦ã‚¶ã§ view_training.html ã‚’é–‹ã            â”‚
    â”‚      (2ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹6ã¤ã®ã‚°ãƒ©ãƒ•)            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3. æ¨è«–ãƒ•ã‚§ãƒ¼ã‚º                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3-1. æ–°ã—ã„å‹•ç”»ã‹ã‚‰ç‰¹å¾´é‡ã‚’æŠ½å‡º                       â”‚
    â”‚      (inference_pipeline.pyå†…ã§è‡ªå‹•å®Ÿè¡Œ)             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3-2. ãƒ¢ãƒ‡ãƒ«ã§ã‚«ãƒƒãƒˆä½ç½®ã‚’äºˆæ¸¬                        â”‚
    â”‚      run_inference.bat "video.mp4"                   â”‚
    â”‚      â†’ outputs/inference_results/result.xml          â”‚
    â”‚      (2å€¤åˆ†é¡ â†’ å¾Œå‡¦ç†ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3-3. Premiere Proã§é–‹ã                              â”‚
    â”‚      result.xmlã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ è©³ç´°ãªæ‰‹é †

### ãƒ•ã‚§ãƒ¼ã‚º1: ãƒ‡ãƒ¼ã‚¿æº–å‚™

#### ã‚¹ãƒ†ãƒƒãƒ—1-1: ç·¨é›†æ¸ˆã¿å‹•ç”»ã¨XMLã‚’ç”¨æ„
```
editxml/
â”œâ”€â”€ video1.mp4
â”œâ”€â”€ video1.xml  (Premiere Proã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸXML)
â”œâ”€â”€ video2.mp4
â””â”€â”€ video2.xml
```

**æœ€ä½30æœ¬ä»¥ä¸Š**ã®å‹•ç”»ã‚’ç”¨æ„ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨

#### ã‚¹ãƒ†ãƒƒãƒ—1-2: å‹•ç”»ã‹ã‚‰ç‰¹å¾´é‡ã‚’æŠ½å‡º
```bash
python -m src.data_preparation.extract_video_features_parallel \
    --video_dir videos \
    --output_dir data/processed/source_features \
    --n_jobs 4
```

**å‡¦ç†æ™‚é–“**: 5-10åˆ†/å‹•ç”»ï¼ˆ10åˆ†ã®å‹•ç”»ã€GPUä½¿ç”¨æ™‚ï¼‰

**æŠ½å‡ºã•ã‚Œã‚‹ç‰¹å¾´é‡**:
- **éŸ³å£°ç‰¹å¾´é‡ï¼ˆ215æ¬¡å…ƒï¼‰**:
  - åŸºæœ¬éŸ³å£°: RMS energy, VADï¼ˆç™ºè©±æ¤œå‡ºï¼‰, ç„¡éŸ³åŒºé–“
  - è©±è€…åŸ‹ã‚è¾¼ã¿: 192æ¬¡å…ƒï¼ˆpyannote.audioï¼‰
  - éŸ³éŸ¿ç‰¹å¾´: MFCCï¼ˆ13æ¬¡å…ƒï¼‰, pitch, spectral_centroidç­‰
  - ãƒ†ã‚­ã‚¹ãƒˆ: Whisperã«ã‚ˆã‚‹éŸ³å£°èªè­˜ãƒ•ãƒ©ã‚°
  
- **æ˜ åƒç‰¹å¾´é‡ï¼ˆ522æ¬¡å…ƒï¼‰**:
  - åŸºæœ¬æ˜ åƒ: ã‚·ãƒ¼ãƒ³å¤‰åŒ–, ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³, é¡•è‘—æ€§ãƒãƒƒãƒ—
  - é¡”ç‰¹å¾´é‡: ä½ç½®, ã‚µã‚¤ã‚º, è¡¨æƒ…ï¼ˆMediaPipeã€10æ¬¡å…ƒï¼‰
  - CLIPç‰¹å¾´é‡: 512æ¬¡å…ƒã®è¦–è¦šçš„æ„å‘³è¡¨ç¾

**å‡ºåŠ›**: `data/processed/source_features/video1_features.csv`

#### ã‚¹ãƒ†ãƒƒãƒ—1-3: XMLã‹ã‚‰ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ™ãƒ«ã‚’æŠ½å‡º
```bash
python -m src.data_preparation.extract_active_labels \
    --xml_dir editxml \
    --feature_dir data/processed/source_features \
    --output_dir data/processed/active_labels
```

**å‡ºåŠ›**: `data/processed/active_labels/video1_active.csv`

**æŠ½å‡ºã•ã‚Œã‚‹æƒ…å ±**:
- time: ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- active: æ¡ç”¨ï¼ˆ1ï¼‰/ ä¸æ¡ç”¨ï¼ˆ0ï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ—1-4: æ™‚ç³»åˆ—ç‰¹å¾´é‡ã‚’è¿½åŠ 
```bash
python scripts/add_temporal_features.py
```

**è¿½åŠ ã•ã‚Œã‚‹ç‰¹å¾´é‡ï¼ˆ83å€‹ï¼‰**:
1. **ç§»å‹•çµ±è¨ˆé‡**: MA5, MA10, MA30, MA60, MA120, STD5, STD30, STD120
2. **å¤‰åŒ–ç‡**: DIFF1, DIFF2, DIFF30
3. **ã‚«ãƒƒãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°**: time_since_prev, time_to_next, cut_duration, position_in_video, cut_density_10s
4. **CLIPé¡ä¼¼åº¦**: clip_sim_prev, clip_sim_next, clip_sim_mean5
5. **éŸ³å£°å¤‰åŒ–**: audio_change_score, silence_to_speech, speech_to_silence, speaker_change, pitch_change
6. **æ˜ åƒå¤‰åŒ–**: visual_motion_change, face_count_change, saliency_movement
7. **ç´¯ç©çµ±è¨ˆ**: cumulative_position, cumulative_adoption_rate

**å‡ºåŠ›**: `data/processed/source_features/video1_features_enhanced.csv`

#### ã‚¹ãƒ†ãƒƒãƒ—1-5: K-Foldç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
```bash
python scripts/create_combined_data_for_kfold.py
```

**å‡¦ç†å†…å®¹**:
1. ç‰¹å¾´é‡ã¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ™ãƒ«ã‚’æ™‚é–“ãƒ™ãƒ¼ã‚¹ã§ãƒãƒ¼ã‚¸
2. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹åˆ†å‰²ï¼ˆé•·ã•1000ãƒ•ãƒ¬ãƒ¼ãƒ ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—500ï¼‰
3. **å‹•ç”»å˜ä½ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–**ï¼ˆGroupKFoldç”¨ï¼‰
   - 67æœ¬ã®å‹•ç”» â†’ 289ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
   - åŒã˜å‹•ç”»ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã¯å¿…ãšåŒã˜Foldã«é…ç½®
4. ç‰¹å¾´é‡ã®æ­£è¦åŒ–ï¼ˆStandardScalerï¼‰

**å‡ºåŠ›**:
- `preprocessed_data/combined_sequences_cut_selection_enhanced.npz` (289ã‚·ãƒ¼ã‚±ãƒ³ã‚¹)
- `preprocessed_data/audio_scaler_cut_selection_enhanced.pkl`
- `preprocessed_data/visual_scaler_cut_selection_enhanced.pkl`
- `preprocessed_data/temporal_scaler_cut_selection_enhanced.pkl`

---

### ãƒ•ã‚§ãƒ¼ã‚º2: å­¦ç¿’

#### ã‚¹ãƒ†ãƒƒãƒ—2-1: K-Fold Cross Validationã§å­¦ç¿’
```bash
train_cut_selection_kfold_enhanced.bat
```

**ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**:
- **å…¥åŠ›**: éŸ³å£°ï¼ˆ235æ¬¡å…ƒï¼‰+ æ˜ åƒï¼ˆ543æ¬¡å…ƒï¼‰+ æ™‚ç³»åˆ—ï¼ˆ6æ¬¡å…ƒï¼‰= **784æ¬¡å…ƒ**
- **åŸ‹ã‚è¾¼ã¿**: å„ãƒ¢ãƒ€ãƒªãƒ†ã‚£ã‚’256æ¬¡å…ƒã«å¤‰æ›
- **èåˆ**: Gated Fusionï¼ˆ3ãƒ¢ãƒ€ãƒªãƒ†ã‚£ã‚’å‹•çš„ã«é‡ã¿ä»˜ã‘ï¼‰
- **ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€**: Transformer Encoderï¼ˆ6å±¤ã€8ãƒ˜ãƒƒãƒ‰ã€256æ¬¡å…ƒï¼‰
- **å‡ºåŠ›**: Activeåˆ¤å®šï¼ˆ2ã‚¯ãƒ©ã‚¹åˆ†é¡: 0=ä¸æ¡ç”¨ã€1=æ¡ç”¨ï¼‰

**å­¦ç¿’è¨­å®š**:
- K-Fold: 5åˆ†å‰²ï¼ˆGroupKFoldï¼‰
- ã‚¨ãƒãƒƒã‚¯æ•°: 50/Fold
- ãƒãƒƒãƒã‚µã‚¤ã‚º: 16
- å­¦ç¿’ç‡: 0.0001
- æå¤±é–¢æ•°: Focal Lossï¼ˆalpha=0.5ã€gamma=2.0ï¼‰
- Total Variation Loss: 0.02ï¼ˆæ™‚é–“çš„ãªæ»‘ã‚‰ã‹ã•ï¼‰
- Adoption Penalty: 10.0ï¼ˆæ¡ç”¨ç‡ã‚’23%ã«è¿‘ã¥ã‘ã‚‹ï¼‰
- Early Stopping: 15ã‚¨ãƒãƒƒã‚¯
- Mixed Precision: æœ‰åŠ¹
- Random Seed: 42ï¼ˆå†ç¾æ€§ç¢ºä¿ï¼‰

**å­¦ç¿’æ™‚é–“**: ç´„2-3æ™‚é–“ï¼ˆ250ã‚¨ãƒãƒƒã‚¯ = 50 Ã— 5 Foldsã€GPUä½¿ç”¨æ™‚ï¼‰

**Early StoppingåŠ¹æœ**:
- å¹³å‡åæŸ: 7.4ã‚¨ãƒãƒƒã‚¯
- å®Ÿéš›ã®å­¦ç¿’: 37ã‚¨ãƒãƒƒã‚¯ï¼ˆ85%å‰Šæ¸›ï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ—2-2: å­¦ç¿’çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç¢ºèª

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `checkpoints_cut_selection_kfold_enhanced/view_training.html` ã‚’é–‹ã

**å¯è¦–åŒ–ã•ã‚Œã‚‹æƒ…å ±**ï¼ˆ2ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°ï¼‰:

**å…¨ä½“é€²æ—ï¼ˆkfold_realtime_progress.pngï¼‰**:
1. F1ã‚¹ã‚³ã‚¢ã®æ¨ç§»ï¼ˆå„Foldï¼‰
2. Validation Lossã®æ¨ç§»ï¼ˆå„Foldï¼‰
3. ç¾åœ¨ã®F1ã‚¹ã‚³ã‚¢ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰
4. é€²æ—çŠ¶æ³ï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰
5. æœ€è‰¯F1ã®æ¨ç§»ï¼ˆå„Foldï¼‰
6. æ¡ç”¨/ä¸æ¡ç”¨ã®æ­£ç¢ºæ€§ï¼ˆRecall & Specificityï¼‰

**å„Foldè©³ç´°ï¼ˆfold_X/training_progress.pngï¼‰**:
1. æå¤±é–¢æ•°ï¼ˆTrain/Val Lossï¼‰
2. æå¤±ã®å†…è¨³ï¼ˆCE Loss vs TV Lossï¼‰
3. åˆ†é¡æ€§èƒ½ï¼ˆAccuracy & F1 Scoreï¼‰
4. Precision, Recall, Specificity
5. æœ€é©é–¾å€¤ã®æ¨ç§»
6. äºˆæ¸¬ã®æ¡ç”¨/ä¸æ¡ç”¨å‰²åˆ

**ä¿å­˜ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«**:
```
checkpoints_cut_selection_kfold_enhanced/
â”œâ”€â”€ fold_1_best_model.pth          # Fold 1æœ€è‰¯ãƒ¢ãƒ‡ãƒ« (F1: 49.42%)
â”œâ”€â”€ fold_2_best_model.pth
â”œâ”€â”€ fold_3_best_model.pth
â”œâ”€â”€ fold_4_best_model.pth
â”œâ”€â”€ fold_5_best_model.pth
â”œâ”€â”€ kfold_summary.csv              # å„Foldã®çµæœã‚µãƒãƒªãƒ¼
â”œâ”€â”€ kfold_comparison.png           # Foldé–“ã®æ¯”è¼ƒã‚°ãƒ©ãƒ•
â”œâ”€â”€ kfold_realtime_progress.png    # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—ã‚°ãƒ©ãƒ•
â”œâ”€â”€ inference_params.yaml          # æ¨è«–ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
â””â”€â”€ view_training.html             # è¨“ç·´çµæœãƒ“ãƒ¥ãƒ¼ã‚¢
```

---

### ãƒ•ã‚§ãƒ¼ã‚º3: æ¨è«–

#### ã‚¹ãƒ†ãƒƒãƒ—3-1: æ–°ã—ã„å‹•ç”»ã§ã‚«ãƒƒãƒˆä½ç½®ã‚’äºˆæ¸¬
```bash
run_inference.bat "path\to\your_video.mp4"
```

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1. **ç‰¹å¾´é‡æŠ½å‡º**: å‹•ç”»ã‹ã‚‰éŸ³å£°ãƒ»æ˜ åƒãƒ»æ™‚ç³»åˆ—ç‰¹å¾´é‡ã‚’æŠ½å‡º
2. **ç‰¹å¾´é‡æ­£è¦åŒ–**: å­¦ç¿’æ™‚ã®Scalerã§æ­£è¦åŒ–
3. **ãƒ¢ãƒ‡ãƒ«æ¨è«–**: Transformer Encoderã§äºˆæ¸¬
   - å‡ºåŠ›: å„ãƒ•ãƒ¬ãƒ¼ãƒ ã®Activeç¢ºç‡ï¼ˆ0ã€œ1ï¼‰
4. **å¾Œå‡¦ç†ï¼ˆã‚¯ãƒªãƒƒãƒ—ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰**:
   - æœ€é©é–¾å€¤ã§Activeåˆ¤å®šï¼ˆä¾‹: -0.558ï¼‰
   - æœ€å°ç¶™ç¶šæ™‚é–“ãƒ•ã‚£ãƒ«ã‚¿: 3.0ç§’æœªæº€ã®ã‚¯ãƒªãƒƒãƒ—ã‚’é™¤å¤–
   - ã‚®ãƒ£ãƒƒãƒ—çµåˆ: 2.0ç§’ä»¥å†…ã®ä¸æ¡ç”¨åŒºé–“ã‚’çµåˆ
   - å„ªå…ˆé †ä½ä»˜ã‘: Activeç¢ºç‡é †ã«ã‚½ãƒ¼ãƒˆ
   - åˆè¨ˆæ™‚é–“åˆ¶é™: ç›®æ¨™90ç§’ã€æœ€å¤§150ç§’
5. **XMLç”Ÿæˆ**: Premiere Proç”¨ã®XMLã‚’ç”Ÿæˆ

**æ¨è«–æ™‚é–“**: ç´„5-10åˆ†/å‹•ç”»ï¼ˆç‰¹å¾´é‡æŠ½å‡ºå«ã‚€ï¼‰

**å‡ºåŠ›**: `outputs/inference_results/result.xml`

#### ã‚¹ãƒ†ãƒƒãƒ—3-2: Premiere Proã§é–‹ã

ç”Ÿæˆã•ã‚ŒãŸXMLã‚’Premiere Proã§é–‹ãã¨ã€è‡ªå‹•çš„ã«ã‚«ãƒƒãƒˆç·¨é›†ã•ã‚ŒãŸã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

## ğŸ”§ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### `configs/config_cut_selection_kfold_enhanced.yaml`
K-Foldå­¦ç¿’è¨­å®š

```yaml
# ãƒ‡ãƒ¼ã‚¿
data_path: 'preprocessed_data/combined_sequences_cut_selection_enhanced.npz'
audio_scaler_path: 'preprocessed_data/audio_scaler_cut_selection_enhanced.pkl'
visual_scaler_path: 'preprocessed_data/visual_scaler_cut_selection_enhanced.pkl'
temporal_scaler_path: 'preprocessed_data/temporal_scaler_cut_selection_enhanced.pkl'

# K-Foldè¨­å®š
n_folds: 5
random_state: 42  # å†ç¾æ€§ç¢ºä¿

# ãƒ¢ãƒ‡ãƒ«è¨­å®š
audio_features: 235
visual_features: 543
temporal_features: 6
d_model: 256
nhead: 8
num_encoder_layers: 6
dim_feedforward: 1024
dropout: 0.15

# å­¦ç¿’è¨­å®š
batch_size: 16
num_epochs: 50
learning_rate: 0.0001
weight_decay: 0.0001
max_grad_norm: 1.0
use_amp: true  # Mixed Precision

# Early Stopping
early_stopping_patience: 15

# æå¤±é–¢æ•°
use_focal_loss: true
focal_alpha: 0.5
focal_gamma: 2.0
label_smoothing: 0.0
tv_weight: 0.02
adoption_penalty_weight: 10.0
target_adoption_rate: 0.23
```

### `checkpoints_cut_selection_kfold_enhanced/inference_params.yaml`
æ¨è«–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆå­¦ç¿’æ™‚ã«è‡ªå‹•ç”Ÿæˆï¼‰

```yaml
# Fold 1ã®æœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
confidence_threshold: -0.558  # æœ€é©é–¾å€¤
min_clip_duration: 3.0        # æœ€å°ã‚¯ãƒªãƒƒãƒ—ç¶™ç¶šæ™‚é–“ï¼ˆç§’ï¼‰
max_gap_duration: 2.0         # ã‚®ãƒ£ãƒƒãƒ—çµåˆã®æœ€å¤§é•·ï¼ˆç§’ï¼‰
target_duration: 90.0         # ç›®æ¨™åˆè¨ˆæ™‚é–“ï¼ˆç§’ï¼‰
max_duration: 150.0           # æœ€å¤§åˆè¨ˆæ™‚é–“ï¼ˆç§’ï¼‰
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è©³ç´°

### ç‰¹å¾´é‡ã®æ¬¡å…ƒæ•°
- **éŸ³å£°**: 235æ¬¡å…ƒ
  - åŸºæœ¬éŸ³å£°: 4æ¬¡å…ƒ
  - è©±è€…åŸ‹ã‚è¾¼ã¿: 192æ¬¡å…ƒ
  - éŸ³éŸ¿ç‰¹å¾´: 16æ¬¡å…ƒ
  - ãƒ†ã‚­ã‚¹ãƒˆ: 3æ¬¡å…ƒ
  - æ™‚ç³»åˆ—: 20æ¬¡å…ƒ

- **æ˜ åƒ**: 543æ¬¡å…ƒ
  - åŸºæœ¬æ˜ åƒ: 10æ¬¡å…ƒ
  - CLIP: 512æ¬¡å…ƒ
  - æ™‚ç³»åˆ—: 21æ¬¡å…ƒ

- **æ™‚ç³»åˆ—**: 6æ¬¡å…ƒ
  - ã‚«ãƒƒãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°: 6æ¬¡å…ƒ

- **åˆè¨ˆ**: 784æ¬¡å…ƒ

### ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿
- **ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é•·**: 1000ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆç´„100ç§’ @ 10FPSï¼‰
- **ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—**: 500ãƒ•ãƒ¬ãƒ¼ãƒ 
- **ç·ãƒ‡ãƒ¼ã‚¿**: 289ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ï¼ˆ67å‹•ç”»ï¼‰
- **K-Fold**: 5åˆ†å‰²ï¼ˆGroupKFoldï¼‰
  - å„Foldã§12-14å‹•ç”»ã‚’æ¤œè¨¼ç”¨ã«ä½¿ç”¨

### ãƒ¢ãƒ‡ãƒ«å‡ºåŠ›
- **Activeåˆ¤å®š**: (batch, seq_len, 2)
  - ã‚¯ãƒ©ã‚¹0: ä¸æ¡ç”¨
  - ã‚¯ãƒ©ã‚¹1: æ¡ç”¨
- **Confidence Score**: logits[1] - logits[0]
  - æ­£ã®å€¤: æ¡ç”¨å‚¾å‘
  - è² ã®å€¤: ä¸æ¡ç”¨å‚¾å‘

---

## ğŸ’¡ ãƒ’ãƒ³ãƒˆ

### ã‚«ãƒƒãƒˆæ•°ã‚’èª¿æ•´ã—ãŸã„
`checkpoints_cut_selection_kfold_enhanced/inference_params.yaml` ã‚’ç·¨é›†ï¼š
- `confidence_threshold` ã‚’ä¸‹ã’ã‚‹ â†’ ã‚«ãƒƒãƒˆæ•°ãŒå¢—ãˆã‚‹
- `confidence_threshold` ã‚’ä¸Šã’ã‚‹ â†’ ã‚«ãƒƒãƒˆæ•°ãŒæ¸›ã‚‹
- `target_duration` ã‚’å¤‰æ›´ â†’ ç›®æ¨™åˆè¨ˆæ™‚é–“ã‚’èª¿æ•´

### å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’å¢—ã‚„ã—ãŸã„
1. æ–°ã—ã„å‹•ç”»ã¨XMLã‚’ `editxml/` ã«è¿½åŠ 
2. ã‚¹ãƒ†ãƒƒãƒ—1-2ã‹ã‚‰å†å®Ÿè¡Œ
3. **æœ€ä½30æœ¬ä»¥ä¸Š**ã‚’æ¨å¥¨ã€ç†æƒ³ã¯50-100æœ¬

### å­¦ç¿’ãŒé€²ã¾ãªã„å ´åˆ
- ãƒ‡ãƒ¼ã‚¿æ•°ã‚’ç¢ºèªï¼ˆæœ€ä½30æœ¬ä»¥ä¸Šæ¨å¥¨ï¼‰
- GPUä½¿ç”¨ã‚’ç¢ºèªï¼ˆ`nvidia-smi`ï¼‰
- è¨­å®šã‚’ç¢ºèªï¼ˆ`configs/config_cut_selection_kfold_enhanced.yaml`ï¼‰
- Early Stoppingã§æ—©æœŸã«æ­¢ã¾ã£ã¦ã„ãªã„ã‹ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã‚’é˜²ãã«ã¯
- **GroupKFold**ã‚’ä½¿ç”¨ï¼ˆåŒã˜å‹•ç”»ã¯åŒã˜Foldã«ï¼‰
- å„Foldã§å®Œå…¨ã«æœªè¦‹ã®ãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡
- ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«è©•ä¾¡ã¯é¿ã‘ã‚‹ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„å ´åˆï¼‰

---

## ğŸ¯ æ€§èƒ½æŒ‡æ¨™

### å­¦ç¿’çµæœï¼ˆK-Fold CVï¼‰
- **å¹³å‡F1ã‚¹ã‚³ã‚¢**: 0.4230 Â± 0.0575
- **æœ€è‰¯F1ã‚¹ã‚³ã‚¢**: 0.4942ï¼ˆFold 1ã€Epoch 4ï¼‰
- **å¹³å‡Recall**: 0.7610 Â± 0.0519ï¼ˆæ¡ç”¨ã‚«ãƒƒãƒˆã‚’è¦‹é€ƒã•ãªã„ï¼‰
- **å¹³å‡Precision**: 0.2983 Â± 0.0580ï¼ˆèª¤æ¤œå‡ºãŒå¤šã„ï¼‰
- **æœ€é©é–¾å€¤**: -0.558 (Fold 1)
- **å­¦ç¿’æ™‚é–“**: ç´„2-3æ™‚é–“ï¼ˆ250ã‚¨ãƒãƒƒã‚¯ã€5 Foldsã€GPUä½¿ç”¨æ™‚ï¼‰

### æ¨è«–çµæœ
- **æ¨è«–æ™‚é–“**: 5~10åˆ†/å‹•ç”»ï¼ˆç‰¹å¾´é‡æŠ½å‡ºå«ã‚€ï¼‰
- **ã‚«ãƒƒãƒˆæ•°**: ç´„8ã€œ12å€‹ã®ã‚¯ãƒªãƒƒãƒ—
- **å‡ºåŠ›å‹•ç”»é•·**: ç´„2åˆ†ï¼ˆ90ç§’ã€œ150ç§’ï¼‰

### ç›®æ¨™é”æˆçŠ¶æ³
| é …ç›® | ç›®æ¨™ | é”æˆ | çŠ¶æ³ |
|------|------|------|------|
| F1ã‚¹ã‚³ã‚¢ | 55% | 42.30% | âŒ æœªé”æˆ (-12.70pt) |
| Recall | 71% | 76.10% | âœ… é”æˆ (+5.10pt) |

---

## ğŸ“– é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [README](../../README.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
- [QUICK_START](../QUICK_START.md) - ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰
- [FINAL_RESULTS](../FINAL_RESULTS.md) - æœ€çµ‚çµæœãƒ¬ãƒãƒ¼ãƒˆ
- [KFOLD_TRAINING_REPORT](../KFOLD_TRAINING_REPORT.md) - K-Foldå­¦ç¿’ãƒ¬ãƒãƒ¼ãƒˆï¼ˆæ”¹å–„ä¸­ï¼‰
- [K_FOLD_CROSS_VALIDATION](../K_FOLD_CROSS_VALIDATION.md) - K-Fold CVè©³ç´°ï¼ˆæ”¹å–„ä¸­ï¼‰

---

**æœ€çµ‚æ›´æ–°**: 2025-12-26  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.0.0ï¼ˆK-Fold CV + æ™‚ç³»åˆ—ç‰¹å¾´é‡ç‰ˆï¼‰
